@page
@model IndexModel
@{
    ViewData["Title"] = "Fixtures";
}

<div class="title-dates">
    <p>Matches</p>
    <button>@DateTime.Now.ToString("MM/dd/yy")</button>
</div>

@foreach (var fixture in Model.Fixtures)
{
    <div class="matches-container">

        <a asp-page="/Standings" asp-route-id="@fixture.Standings.Id">
            <div class="matches-comp">
                <div class="matches-comp-flag">
                    <img src="@fixture.Standings.Tournament.Country.Flag" alt="flag" />
                </div>
                <div class="matches-comp-name">@fixture.Standings.Tournament.Name</div>
            </div>
        </a>

        @foreach (var match in fixture.Matches)
        {
            var result = match.Incidents.FirstOrDefault(x => x.Class == "FT");

            <div class="match-container">
                <a class="match-home-team" asp-page="/Club" asp-route-id="@match.HomeTeam.Id">
                    @match.HomeTeam.Name
                </a>

                @if (result is null)
                {
                    <a class="match-result" asp-page="/Match" asp-route-id="@match.Id">
                        @match.KickOff.ToString("HH:mm")
                    </a>
                }
                else
                {
                    <a class="match-result" asp-page="/Match" asp-route-id="@match.Id">
                        @(result.HomeScore):@(result.AwayScore)
                    </a>
                }

                <a class="match-away-team" asp-page="/Club" asp-route-id="@match.AwayTeam.Id">
                    @match.AwayTeam.Name
                </a>
            </div>
        }

    </div>
}
